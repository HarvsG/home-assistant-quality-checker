# overkiz: entity-unique-id

| Info   | Value                                                                    |
|--------|--------------------------------------------------------------------------|
| Name   | [overkiz](https://www.home-assistant.io/integrations/overkiz/) |
| Rule   | [entity-unique-id](https://developers.home-assistant.io/docs/core/integration-quality-scale/rules/entity-unique-id)                                                     |
| Status | **done**                                       |
| Reason |                                                                          |

## Overview

The `entity-unique-id` rule requires all entities created by an integration to have a unique ID. This allows Home Assistant to track entities across restarts and enables user customizations.

The `overkiz` integration appears to fully follow this rule. The primary mechanisms for setting unique IDs are:

1.  **`OverkizEntity` (in `homeassistant/components/overkiz/entity.py`):**
    This base class, from which many specific entities derive (either directly or indirectly), sets the unique ID using the device's URL:
    ```python
    # homeassistant/components/overkiz/entity.py
    class OverkizEntity(CoordinatorEntity[OverkizDataUpdateCoordinator]):
        # ...
        def __init__(
            self, device_url: str, coordinator: OverkizDataUpdateCoordinator
        ) -> None:
            # ...
            self._attr_unique_id = self.device.device_url
            # ...
    ```
    The `device.device_url` (e.g., `io://1234-5678-9012/1` or `rtds://1234-5678-9012/3#2`) provided by the `pyoverkiz` library is inherently unique for each controllable device or sub-component. This is a suitable unique ID for entities that directly represent such a device/component.

2.  **`OverkizDescriptiveEntity` (in `homeassistant/components/overkiz/entity.py`):**
    This class, also inheriting from `OverkizEntity`, is used for entities that represent a specific aspect (e.g., a particular sensor reading or a button for a command) of a device. It extends the unique ID from `OverkizEntity` by appending the `entity_description.key`:
    ```python
    # homeassistant/components/overkiz/entity.py
    class OverkizDescriptiveEntity(OverkizEntity):
        # ...
        def __init__(
            self,
            device_url: str,
            coordinator: OverkizDataUpdateCoordinator,
            description: EntityDescription,
        ) -> None:
            super().__init__(device_url, coordinator)
            self.entity_description = description
            self._attr_unique_id = f"{super().unique_id}-{self.entity_description.key}"
            # ...
    ```
    Since `super().unique_id` is the `device.device_url` and `self.entity_description.key` is typically a unique string (often an enum member like `OverkizState.CORE_BATTERY_LEVEL` or `OverkizCommand.MY`) for each described feature, this creates a unique ID for these sub-entities. This pattern is correctly used across various platforms like `sensor.py`, `button.py`, `number.py`, `switch.py`, `binary_sensor.py`, `select.py`, and `alarm_control_panel.py`.

3.  **Scene Entities (`homeassistant/components/overkiz/scene.py`):**
    Scene entities directly set their unique ID based on the scenario's OID (Object ID) from the `pyoverkiz` library, which is unique.
    ```python
    # homeassistant/components/overkiz/scene.py
    class OverkizScene(Scene):
        def __init__(self, scenario: Scenario, client: OverkizClient) -> None:
            # ...
            self._attr_unique_id = self.scenario.oid
    ```

4.  **Specific Entity Implementations:**
    *   Most entity platforms (light, lock, siren, climate, most water heaters, generic covers) inherit from `OverkizEntity` and thus use `device_url` as their unique ID.
    *   The `LowSpeedCover` in `homeassistant/components/overkiz/cover/vertical_cover.py` correctly appends `_low_speed` to the unique ID derived from `OverkizEntity` to differentiate it from the standard cover entity for the same `device_url`.
    *   The `OverkizHomeKitSetupCodeSensor` in `homeassistant/components/overkiz/sensor.py` inherits from `OverkizEntity` and uses `device_url`.

The presence of unique ID migration code (`_async_migrate_entries` in `homeassistant/components/overkiz/__init__.py`) further indicates that unique IDs are a considered aspect of this integration and are actively managed.

Based on this review, all entities generated by the `overkiz` integration are assigned a unique ID through a consistent and robust mechanism.

## Suggestions

No suggestions needed.

_Created at 2025-05-28 12:11:35. Prompt tokens: 86902, Output tokens: 1179, Total tokens: 90839_
